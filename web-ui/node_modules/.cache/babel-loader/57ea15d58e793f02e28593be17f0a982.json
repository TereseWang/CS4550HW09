{"ast":null,"code":"import { createStore, combineReducers } from 'redux'; //referenced the fetch Structure that store the value of the web from lecture\n//code SPA Structure from Nat Tuck CS4550 Northeastern University\n\nfunction users(state = [], action) {\n  switch (action.type) {\n    case 'users/set':\n      return action.data;\n\n    default:\n      return state;\n  }\n}\n\nfunction user_form(state = {}, action) {\n  switch (action.type) {\n    case 'user_form/set':\n      return action.data;\n\n    default:\n      return state;\n  }\n}\n\nexport function fetch_foods() {\n  api_get(\"/foods\").then(data => {\n    data = sortFood(data);\n    store.dispatch({\n      type: 'foods/set',\n      data: data\n    });\n  });\n}\nexport function fetch_food(id) {\n  api_get(\"/foods/\" + id).then(data => store.dispatch({\n    type: 'food_form/set',\n    data: data\n  }));\n}\nexport async function create_food(food) {\n  let data = new FormData();\n  data.append(\"food[user_id]\", food.user_id);\n  data.append(\"food[like]\", JSON.stringify([]));\n  data.append(\"food[dislike]\", JSON.stringify([]));\n  data.append(\"food[type]\", food.type);\n  data.append(\"food[body]\", food.body);\n  data.append(\"food[brand]\", food.brand);\n  data.append(\"food[price]\", food.price);\n\n  if (food.photo === \"undefined\") {\n    food[\"photo\"] = \"\";\n  }\n\n  data.append(\"food[photo]\", food.photo);\n  let resp = await fetch(\"http://kittenlover-backend.teresewang.com/api/v1/foods\", {\n    method: \"POST\",\n    body: data\n  });\n  return await resp.json();\n}\nexport async function update_food(food) {\n  let data = new FormData();\n  data.append(\"food[user_id]\", food.user_id);\n  data.append(\"food[like]\", JSON.stringify([]));\n  data.append(\"food[dislike]\", JSON.stringify([]));\n  data.append(\"food[type]\", food.type);\n  data.append(\"food[body]\", food.body);\n  data.append(\"food[brand]\", food.brand);\n  data.append(\"food[price]\", food.price);\n  data.append(\"food[photo]\", food.photo);\n  let resp = await fetch(\"http://kittenlover-backend.teresewang.com/api/v1/foods/\" + food.id, {\n    method: \"PATCH\",\n    body: data\n  });\n  return await resp.json();\n}\nexport async function delete_food(id) {\n  let data = new FormData();\n  data.append(\"id\", id);\n  fetch(\"http://kittenlover-backend.teresewang.com/api/v1/foods/\" + id, {\n    method: 'DELETE',\n    body: data\n  }).then(resp => {\n    if (!resp.ok) {\n      let action = {\n        type: 'error/set',\n        data: 'Unable to delete event.'\n      };\n      store.dispatch(action);\n    } else {\n      fetch_foods();\n    }\n  });\n}\n\nfunction session(state = load_session(), action) {\n  switch (action.type) {\n    case 'session/set':\n      save_session(action.data);\n      return action.data;\n\n    case 'session/clear':\n      delete_session();\n      return null;\n\n    default:\n      return state;\n  }\n}\n\nfunction save_session(sess) {\n  let session = Object.assign({}, sess, {\n    time: Date.now()\n  });\n  localStorage.setItem(\"session\", JSON.stringify(session));\n}\n\nfunction delete_session() {\n  localStorage.removeItem(\"session\");\n}\n\nfunction load_session() {\n  let session = localStorage.getItem(\"session\");\n\n  if (!session) {\n    return null;\n  }\n\n  session = JSON.parse(session);\n  let age = Date.now() - session.time;\n  let hours = 60 * 60 * 1000;\n\n  if (age < 24 * hours) {\n    return session;\n  } else {\n    return null;\n  }\n}\n\nfunction error(state = null, action) {\n  switch (action.type) {\n    case 'error/set':\n      return action.data;\n\n    case 'session/set':\n      return null;\n\n    default:\n      return state;\n  }\n}\n\nfunction root_reducer(state, action) {\n  let reducer = combineReducers({\n    users,\n    user_form,\n    session,\n    error\n  });\n  return reducer(state, action);\n}\n\nlet store = createStore(root_reducer);\nexport default store;","map":{"version":3,"sources":["/media/psf/Home/Desktop/CS4550HW09/web-ui/src/store.js"],"names":["createStore","combineReducers","users","state","action","type","data","user_form","fetch_foods","api_get","then","sortFood","store","dispatch","fetch_food","id","create_food","food","FormData","append","user_id","JSON","stringify","body","brand","price","photo","resp","fetch","method","json","update_food","delete_food","ok","session","load_session","save_session","delete_session","sess","Object","assign","time","Date","now","localStorage","setItem","removeItem","getItem","parse","age","hours","error","root_reducer","reducer"],"mappings":"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","sourcesContent":["import { createStore, combineReducers } from 'redux';\n//referenced the fetch Structure that store the value of the web from lecture\n//code SPA Structure from Nat Tuck CS4550 Northeastern University\n\nfunction users(state = [], action) {\n  switch (action.type) {\n    case 'users/set':\n      return action.data;\n    default:\n      return state;\n  }\n}\n\nfunction user_form(state = {}, action) {\n  switch (action.type) {\n    case 'user_form/set':\n      return action.data;\n    default:\n      return state;\n  }\n}\n\nexport function fetch_foods() {\n  api_get(\"/foods\").then((data) => {\n    data = sortFood(data)\n    store.dispatch({\n    type: 'foods/set',\n    data: data,\n  })});\n}\n\nexport function fetch_food(id) {\n  api_get(\"/foods/\"+id).then((data) => store.dispatch({\n    type: 'food_form/set',\n    data: data,\n  }));\n}\n\nexport async function create_food(food) {\n  let data = new FormData();\n  data.append(\"food[user_id]\", food.user_id);\n  data.append(\"food[like]\", JSON.stringify([]))\n  data.append(\"food[dislike]\", JSON.stringify([]))\n  data.append(\"food[type]\", food.type);\n  data.append(\"food[body]\", food.body);\n  data.append(\"food[brand]\", food.brand)\n  data.append(\"food[price]\", food.price)\n  if (food.photo === \"undefined\") {\n    food[\"photo\"] = \"\";\n  }\n  data.append(\"food[photo]\", food.photo);\n  let resp = await fetch(\"http://kittenlover-backend.teresewang.com/api/v1/foods\", {\n    method: \"POST\",\n    body: data,\n  })\nreturn await resp.json();\n}\n\n\nexport async function update_food(food) {\n  let data = new FormData();\n  data.append(\"food[user_id]\", food.user_id);\n  data.append(\"food[like]\", JSON.stringify([]))\n  data.append(\"food[dislike]\", JSON.stringify([]))\n  data.append(\"food[type]\", food.type);\n  data.append(\"food[body]\", food.body);\n  data.append(\"food[brand]\", food.brand)\n  data.append(\"food[price]\", food.price)\n  data.append(\"food[photo]\", food.photo);\n  let resp = await fetch(\"http://kittenlover-backend.teresewang.com/api/v1/foods/\" + food.id, {\n    method: \"PATCH\",\n    body: data,\n  })\nreturn await resp.json();\n}\n\nexport async function delete_food(id) {\n  let data = new FormData();\n  data.append(\"id\", id);\n  fetch(\"http://kittenlover-backend.teresewang.com/api/v1/foods/\" + id, {\n    method: 'DELETE',\n    body: data,\n  }).then((resp) => {\n    if(!resp.ok){\n      let action = {\n        type: 'error/set',\n        data: 'Unable to delete event.',\n      };\n      store.dispatch(action);\n    }else {\n      fetch_foods();\n    }\n  });\n}\n\n\nfunction session(state = load_session(), action) {\n  switch (action.type) {\n    case 'session/set':\n      save_session(action.data);\n      return action.data;\n    case 'session/clear':\n      delete_session();\n      return null;\n    default:\n      return state;\n  }\n}\n\nfunction save_session(sess) {\n  let session = Object.assign({}, sess, {time: Date.now()});\n  localStorage.setItem(\"session\", JSON.stringify(session));\n}\n\nfunction delete_session() {\n  localStorage.removeItem(\"session\");\n}\n\nfunction load_session() {\n  let session = localStorage.getItem(\"session\");\n  if (!session) {\n    return null;\n  }\n  session = JSON.parse(session);\n  let age = Date.now() - session.time;\n  let hours = 60*60*1000;\n  if (age < 24 * hours) {\n    return session;\n  }\n  else {\n    return null;\n  }\n}\n\nfunction error(state = null, action) {\n  switch (action.type) {\n    case 'error/set':\n      return action.data;\n    case 'session/set':\n      return null;\n    default:\n      return state;\n  }\n}\n\n\nfunction root_reducer(state, action) {\n    let reducer = combineReducers({\n        users, user_form, session, error,\n    });\n    return reducer(state, action);\n}\n\nlet store = createStore(root_reducer);\nexport default store;\n"]},"metadata":{},"sourceType":"module"}